<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WB BOT</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <h1>WB BOT</h1>
    <h2>Мои конфигурации</h2>
    <button id="addConfigBtn">Добавить конфигурацию</button>
    <div id="configurations"></div>

    <script>
        const themeParams = Telegram.WebApp.themeParams;
        document.body.style.backgroundColor = themeParams.bg_color || "#000";
        document.body.style.color = themeParams.text_color || "#FFF";
        Telegram.WebApp.setBackgroundColor(themeParams.bottom_bar_color || "#000");

        const configurations = [];
        let configCount = 0;

        document.getElementById('addConfigBtn').addEventListener('click', () => {
            configCount++;
            const configDiv = document.createElement('div');
            configDiv.innerHTML = `
                <input type="text" placeholder="Мой товар" id="product_${configCount}">
                <input type="text" placeholder="URL1" id="url1_${configCount}">
                <input type="text" placeholder="URL2" id="url2_${configCount}">
                <input type="text" placeholder="URL3" id="url3_${configCount}">
                <input type="text" placeholder="Скидка" id="discount_${configCount}">
                <input type="text" placeholder="Минимальная цена" id="minPrice_${configCount}">
                <select id="action_${configCount}">
                    <option value="Up">Up</option>
                    <option value="Down">Down</option>
                    <option value="Repeat">Repeat</option>
                </select>
                <button onclick="saveConfig(${configCount})">Сохранить конфигурацию</button>
                <button onclick="deleteConfig(${configCount})">Удалить конфигурацию</button>
            `;
            document.getElementById('configurations').appendChild(configDiv);
        });

        function saveConfig(id) {
            const keys = [
                `product_${id}`,
                `url1_${id}`,
                `url2_${id}`,
                `url3_${id}`,
                `discount_${id}`,
                `minPrice_${id}`,
                `action_${id}`
            ];

            keys.forEach(key => {
                const value = document.getElementById(key).value;
                Telegram.WebApp.storage.setItem(key, value);
            });
        }

        function deleteConfig(id) {
            const keys = [
                `product_${id}`,
                `url1_${id}`,
                `url2_${id}`,
                `url3_${id}`,
                `discount_${id}`,
                `minPrice_${id}`,
                `action_${id}`
            ];

            keys.forEach(key => {
                Telegram.WebApp.storage.removeItem(key);
            });

            document.getElementById(`config_${id}`).remove();
        }

        function loadConfigs() {
            Telegram.WebApp.storage.getKeys(keys => {
                keys.forEach(key => {
                    const value = Telegram.WebApp.storage.getItem(key);
                    // Здесь можно восстановить значения в интерфейсе
                });
            });
        }

        window.onload = loadConfigs;
    </script>
</body>
</html>
